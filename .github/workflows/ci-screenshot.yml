name: "ðŸ“· Screenshot Tests"

on:
  workflow_call:

jobs:

  record:
    name: "ðŸ“¸ Record"
    timeout-minutes: 10

    permissions:
      contents: read
    
    runs-on: ubuntu-24.04
    steps:

      - name: "Checkout ${{ github.ref }} branch in ${{ github.repository }} repository."
        uses: actions/checkout@v4

      - name: "Set up Java."
        uses: actions/setup-java@v4
        with:
          java-version-file: .java-version
          distribution: temurin

      - name: "Set up Gradle."
        uses: gradle/actions/setup-gradle@v3

      - name: "Record screenshots."
        run: >
          ./gradlew
          --continue
          --stacktrace
          updateDebugScreenshotTest

  verify:
    name: "âš– Verify"
    needs:
      - record
    timeout-minutes: 10

    permissions:
      contents: read

    runs-on: ubuntu-24.04
    steps:

      - name: "Checkout ${{ github.ref }} branch in ${{ github.repository }} repository."
        uses: actions/checkout@v4

      - name: "Set up Java."
        uses: actions/setup-java@v4
        with:
          java-version-file: .java-version
          distribution: temurin

      - name: "Set up Gradle."
        uses: gradle/actions/setup-gradle@v3

      - name: "Verify screenshots."
        run: >
          ./gradlew
          --continue
          --stacktrace
          validateDebugScreenshotTest
